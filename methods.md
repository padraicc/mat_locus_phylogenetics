***Phylogenetic analysis of mat genes***

To identify the *mat* a-1 gene sequence in *N. tetraperma*, we used
blastn from BLAST 2.6.0+ [1] to search the *N. crassa* (FGSC 4200)
partial sequence of the *mat a* strain (GenBank accession number M54787)
against the L6 2509 *N. tetrasperma* reference *mat* a genome (version
1)
(ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/213/195/GCA_000213195.1_v1.0).
We then identified the *mat* a-1 gene in *N. tetrasperma* 2509 *as*
gene2113 from the L6 2509 *N. tetrasperma* reference annotation file, as
this gene overlapped the best blast hit coordinates and encoded a
HMG-Box domain in its protein. The sequence of gene2113, identified as
*mat* a-1 gene, was then used as the query sequence in a blastn search
against each of the denovo assemblies of the *mat* a *Neurospora*
genomes listed in Table 1 and Supplementary Table 5. The top result for
each blastn search against an *N. tetrasperma* genome was extracted as
the *mat* a-1 sequence for that genome. The extracted *mat* a-1
sequences from the *Neurospora mat* a genomes used in this study were
then combined with the mat *a-1* alignments of heterothallic species
from Strandberg et al. [2] and aligned using MUSCLE v3.8.31 to generate
a *mat* a-1 alignment. Due to the lack of polymorphism observed within
each *N. tetrasperma* lineage in the *mat* a-1 alignment for
phylogenetic analysis, a single *N. tetrasperma* *mat* a strain was
selected from each lineage in the phylogenetic analysis described below.

We obtained the location of the *mat* A-1, *mat* A-3 and *mat* A-3 gene
sequences for *N. crassa* from the gff annotation file of the *N.
crassa* reference genome (version 12)
(<ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/182/925/GCF_000182925.2_NC12/)>
and also obtained the *N. tetrasperma* *mat* A sequences from the
annotation file of the *N. tetrasperma 2508* reference genome (version 2
(<ftp://ftp.ncbi.nlm.nih.gov/genomes/refseq/fungi/Neurospora_tetrasperma/all_assembly_versions/GCF_000213175.1_v2.0/)>.
We used the *mat* A-1, *mat* A-3 and *mat* A-3 sequences as the queries
in blastn searches against the *mat* A Neurospora genomes listed in
Table 1 and Supplementary Table S5, and the *Neurospora discreta* (FGSC
8579) reference genome sequence
(<http://genome.jgi.doe.gov/Neudi1/Neudi1.download.ftp.html)>. The *mat*
A-1, *mat* A-2 and *mat* A-3 extracted from the *Neurospora* *ma*t A
genomes were then combined with the appropriate *mat* A alignment of
heterothallic species mat A sequences from Strandberg *et al.* [2]
(e.g., *mat* A-1 sequences combined with *mat* A-1 heterothallic
alignment). The separate *mat* A-1, *mat* A-2 and *mat* A-3 alignments
were then generated by aligning the sequences using MUSCLE v3.8.3 [3].
The *mat* A-1, *mat* A-2 and *mat* A-3 alignments were then concatenated using
the concat tool in the python package egglib [4] (v3.0.0b13) to produce
a single *mat* A alignment referred to here as *mat*A123. Due to the
lack of polymorphism observed within each *N. tetrasperma* lineage in the
*mat*A123 alignment, a single *N. tetrasperma* *mat* A strain was
selected from each lineage in the phylogenetic analysis.

A maximum likelihood tree was reconstructed for the *mat* a-1 alignment
and the *mat*A123 using RAxML [5] v8.2.4 with a GTRGAMMA model and 1000
bootstrap replicates were performed. All scripts used to carry out the
above steps and the phylogenetic trees generated are located at
<https://github.com/padraicc/mat_locus_phylogenetics>.

**References**

1\. Altschul SF, Gish W, Miller W, Myers EW, Lipman DJ. Basic local
alignment search tool. J Mol Biol. 1990;215: 403–410.

2\. Strandberg R, Nygren K, Menkis A, James TY, Wik L, Stajich JE, et al.
Conflict between reproductive gene trees and species phylogeny among
heterothallic and pseudohomothallic members of the filamentous
ascomycete genus Neurospora. Fungal Genet Biol. 2010;47: 869–878.
doi:16/j.fgb.2010.06.008

3\. Edgar RC. MUSCLE: multiple sequence alignment with high accuracy and
high throughput. Nucleic Acids Res. 2004;32: 1792–1797.

4\. Mita SD, Siol M. EggLib: processing, analysis and simulation tools
for population genetics and genomics. BMC Genet. 2012;13: 27.
doi:10.1186/1471-2156-13-27

5\. Stamatakis A. RAxML-VI-HPC: maximum likelihood-based phylogenetic
analyses with thousands of taxa and mixed models. Bioinforma Oxf Engl.
2006;22: 2688–2690. doi:10.1093/bioinformatics/btl446
